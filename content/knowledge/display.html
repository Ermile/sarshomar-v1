{%extends display.main%}

{%block content%}
  <aside>
   <div class="group">
    <div class="options-box">
      <span class="ac-custom ac-checkmark">
       <input id="questions1" type="checkbox" name='pollcat' value="sarshomar" {%if checkbox.pollcat == 'sarshomar'%}checked{%endif%}>
       <label for="questions1">{%trans "Sarshomar"%}</label>
       {%if checkbox.pollcat == 'sarshomar'%}{{block('check_svg')}}{%endif%}
      </span>
      <span class="ac-custom ac-checkmark">
       <input id="questions2" type="checkbox" name='pollcat' value="civility" {%if checkbox.pollcat == 'civility'%}checked{%endif%}>
       <label for="questions2">{%trans "Civility"%}</label>
       {%if checkbox.pollcat == 'civility'%}{{block('check_svg')}}{%endif%}
     </span>
    </div>
   </div>
   <div class="group">
     <div class="full-line-title" data-title='{%trans "question type"%}'></div>
     <div class="options-box">
      <span class="ac-custom ac-checkmark reverse">
        <input id="type1" type="checkbox" name='pollgender' value="poll" {%if chechbox.pollgender == 'poll' %}chechek{%endif%}>
        <label for="type1">{%trans "Poll"%}</label>
       {%if checkbox.pollgender == 'poll'%}{{block('check_svg')}}{%endif%}
      </span>
      <span class="ac-custom ac-checkmark reverse">
       <input id="type2" type="checkbox" name='pollgender' value="quiz" {%if chechbox.pollgender == 'quiz' %}chechek{%endif%}>
       <label for="type2">{%trans "quiz"%}</label>
       {%if checkbox.pollgender == 'quiz'%}{{block('check_svg')}}{%endif%}
      </span>
      <span class="ac-custom ac-checkmark reverse">
       <input id="type4" type="checkbox" name='pollgender' value="survey" {%if chechbox.pollgender == 'survey' %}chechek{%endif%}>
       <label for="type4">{%trans "survey"%}</label>
       {%if checkbox.pollgender == 'survey'%}{{block('check_svg')}}{%endif%}
      </span>
    </div>
   </div>
   <div class="group">
    <div class="full-line-title" data-title='{%trans "according to survey"%}'></div>
    <div class="options-box">
     <span class="ac-custom ac-checkmark">
      <input id="accord1" type="checkbox" name="polltype" value="multiplechoice" {%if checkbox.polltype == 'multiplechoice' %}checked{%endif%}>
      <label for="accord1">{%trans "multiplechoice"%}</label>
      {%if checkbox.polltype == 'multiplechoice'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord2" type="checkbox" name="polltype" value="descriptive" {%if checkbox.polltype == 'descriptive' %}checked{%endif%}>
      <label for="accord2">{%trans "descriptive"%}</label>
      {%if checkbox.polltype == 'descriptive'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord3" type="checkbox" name="polltype" value="notification" {%if checkbox.polltype == 'notification' %}checked{%endif%}>
      <label for="accord3">{%trans "notification"%}</label>
      {%if checkbox.polltype == 'notification'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord4" type="checkbox" name="polltype" value="upload" {%if checkbox.polltype == 'upload' %}checked{%endif%}>
      <label for="accord4">{%trans "upload"%}</label>
      {%if checkbox.polltype == 'upload'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord5" type="checkbox" name="polltype" value="starred" {%if checkbox.polltype == 'starred' %}checked{%endif%}>
      <label for="accord5">{%trans "starred"%}</label>
      {%if checkbox.polltype == 'starred'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord6" type="checkbox" name="polltype" value="numerical" {%if checkbox.polltype == 'numerical' %}checked{%endif%}>
      <label for="accord6">{%trans "numerical"%}</label>
      {%if checkbox.polltype == 'numerical'%}{{block('check_svg')}}{%endif%}
     </span>
     <span class="ac-custom ac-checkmark">
      <input id="accord7" type="checkbox" name="polltype" value="sort" {%if checkbox.polltype == 'sort' %}checked{%endif%}>
      <label for="accord7">{%trans "sort"%}</label>
      {%if checkbox.polltype == 'sort'%}{{block('check_svg')}}{%endif%}
     </span>
    </div>
   </div>
   <div class="group">
    <div class="full-line-title" data-title='{%trans "survey time"%}'></div>
    <div class="options-box">
      <span class="ac-custom ac-checkmark reverse">
        <input id="time1" type="checkbox" name='status' value="publish" {%if chechbox.status == 'publish'%}checked{%endif%}>
        <label for="time1">{%trans "publish"%}</label>
        {%if checkbox.status == 'publish'%}{{block('check_svg')}}{%endif%}
      </span>
      <span class="ac-custom ac-checkmark reverse">
        <input id="time2" type="checkbox" name='status' value="expired" {%if chechbox.status == 'expired'%}checked{%endif%}>
        <label for="time2">{%trans "expire"%}</label>
        {%if checkbox.status == 'expired'%}{{block('check_svg')}}{%endif%}
      </span>
    </div>
   </div>
   <!-- <div class="group">
    <div class="full-line-title" data-title='{%trans "prize"%}'></div>
    <div class="options-box prize-box">
      <span class="ac-custom ac-checkmark" >
       <input id="prize1" type="checkbox" name='prize'>
       <label for="prize1">{%trans "پاسخ‌دهی"%}</label>
      </span>
      <span class="ac-custom ac-checkmark">
       <input id="prize2" type="checkbox" name='prize'>
       <label for="prize2">{%trans "قرعه‌کشی"%}</label>
      </span>
    </div>
   </div> -->
   <div class="group">
    <div class="full-line-title" data-title='{%trans "filters"%}'></div>
    <div class="options-box filters-box">
     <div class="select-box">
      <label for="marrital">{%trans "marrital"%}</label>
       <select name="marrital" id="marrital">
        <option value="">{%trans ""%}</option>
        <option value="single">{%trans "single"%}</option>
        <option value="marriade">{%trans "marriade"%}</option>
      </select>
     </div>
     <div class="select-box">
       <label for="employmentstatus">{%trans "employmentstatus"%}</label>
       <select name="employmentstatus" id="employmentstatus">
        <option value="">{%trans ""%}</option>
        <option value="employee">{%trans "employee"%}</option>
        <option value="unemployee">{%trans "unemployee"%}</option>
        <option value="retired">{%trans "retired"%}</option>
       </select>
     </div>
     <div class="select-box">
      <label for="gender">{%trans "gender"%}</label>
      <select name="gender" id="gender">
        <option value="">{%trans ""%}</option>
        <option value="male">{%trans "male"%}</option>
        <option value="female">{%trans "female"%}</option>
      </select>
     </div>
     <div class="select-box">
      <label for="graduation">{%trans "graduation"%}</label>
      <select name="graduation" id="graduation">
        <option value="">{%trans ""%}</option>
        <option value="illiterate">{%trans "illiterate"%}</option>
        <option value="undergraduate">{%trans "undergraduate"%}</option>
        <option value="graduate">{%trans "graduate"%}</option>
        <option value="under diploma">{%trans "under diploma"%}</option>
        <option value="diploma">{%trans "diploma"%}</option>
        <option value="2 year college">{%trans "2 year college"%}</option>
        <option value="bachelor">{%trans "bachelor"%}</option>
        <option value="master">{%trans "master"%}</option>
        <option value="phd">{%trans "phd"%}</option>
        <option value="other">{%trans "other"%}</option>
      </select>
     </div>
     <div class="select-box">
      <label for="country">{%trans "country"%}</label>
      <input name="country" id="country" value="">
     </div>
     <div class="select-box">
      <label for="age">{%trans "age"%}</label>
      <input name="age" id="age" value="">
     </div>
     <div class="select-box">
      <label for="province">{%trans "province"%}</label>
      <input name="province" id="province" value="">
     </div>
     <div class="select-box">
      <label for="religion">{%trans "religion"%}</label>
      <input name="religion" id="religion" value="">
     </div>
     <div class="select-box">
      <label for="language">{%trans "language"%}</label>
      <input name="language" id="language" value="">
     </div>

    </div>
   </div>
  </aside>

<div class="main">

  <div class="row">
    <div class="span1"></div>
    <div class="span10">
     <div class="search-box">
      <input type="text" name="search" placeholder='{%trans "Search"%}' class="pollsearch" value="{{search_value}}" autocomplete='off'>
      <button class="search-button"><i class="fa fa-search" aria-hidden="true"></i></button>
     </div>
     <div class="search-result" data-xhr='search-result' id="search-result">
       {%include display.result%}
     </div>
    </div><!-- /.span9 -->
  </div>
</div>
{%endblock%}


{%block foot_js%}
<script type="text/javascript" src="/static/js/svgcheckbox.js"></script>
<script>
$(document).ready(function()
{
 $("aside .full-line-title").click(function()
 {
  var options_box = $(this).next(".options-box");
//add actived and close classes to options-box on aside
  if(options_box.is(":hidden"))
  {
    options_box.addClass( "actived" );
    options_box.removeClass( "closed" );
  }

  if(options_box.is(":visible"))
  {
    options_box.addClass( "closed" );
    options_box.removeClass( "actived" );
  }

  options_box.slideToggle();

 });

 $("aside input[type=checkbox]").click(function()
 {
  $(this).parent('.ac-custom').toggleClass('selected');
 });

 $(document).on('click', '.star', function(){
   id = $(this).parent('li').attr("data-id");
   _self = $(this);
   $(this).ajaxify(
      {
        ajax:
        {
          data:
          {
            'type': 'faivorites',
            'id': id
          },
          abort: true,
          success: function(e, data, x)
          {
            $(_self).toggleClass("starred");
          },
          method: 'post'
        }
      });
 });

  $(document).on('change', 'select', function(){

    var new_url;
    var url        = window.location.pathname;
    var pattern    = new RegExp( name + '\=([^\/]*)');
    var exist_value_url = null;

    name  = $(this).attr('name');
    value = $(this).val();

    match = url.match(pattern);
    if(match !== null)
    {
      exist_value_url = match[1];
    }

    if(match !== null)
    {
      new_url = url.replace(pattern, name + '=' + value);
    }
    else if(value == '')
    {
      new_url = url.replace(pattern, '');
    }
    else
    {
      if(/\/$/.test(url))
      {
        new_url = url + name + '=' + value;
      }
      else
      {
        new_url = url + '/' + name + '=' + value;
      }
    }
    Navigate({ url: new_url });
  });

  $(document).on('change', 'input[type=checkbox]', function(){

    var new_url;
    var url        = window.location.pathname;
    var pattern    = new RegExp( name + '\=([^\/]*)');
    var is_checked = false;
    var exist_value_url = null;

    name  = $(this).attr('name');
    value = $(this).val();

    match = url.match(pattern);
    if(match !== null)
    {
      exist_value_url = match[1];
    }
    if($(this).prop("checked"))
    {
      is_checked = false;
    }
    else
    {
      is_checked = true;
    }

    if(is_checked)
    {
      new_url = url.replace(pattern, '');
    }
    else
    {
      if(match !== null)
      {
        new_url = url.replace(pattern, name + '=' + value);
      }
      else
      {
        if(/\/$/.test(url))
        {
          new_url = url + name + '=' + value;
        }
        else
        {
          new_url = url + '/' + name + '=' + value;
        }

      }

    }
    console.log(new_url);
    console.log(is_checked);
    console.log(exist_value_url);
    Navigate({ url: new_url });
  });
});

</script>
{%endblock%}

{%block search_result%}
  {%if poll_list%}
      <div class="polls-head">
        <span class="fa fa-star star" aria-hidden="true"></span>
        <span class="type">{%trans "Type"%}</span>
        <span class="title">{%trans "Title"%}</span>
        <span class="comments-count">{%trans "Comments"%}</span>
        <span class="votes-count">{%trans "Votes"%}</span>
        <span class="date">{%trans "Date"%}</span>
      </div>
      <ul class="polls-body">
  {%for key, value in poll_list%}
        <li class="polls-row{%if value.status == 'draft'%}{{' star'}}{%endif%}" data-id="{{value.id}}">
          <span class="fa fa-star star {%if value.faivorites%}starred{%endif%}" aria-hidden="true"></span>
          <span class="type" aria-hidden="true"><i class="fa fa-{{value.type}}"></i> </span>
          <span class="title"><a href="{{base.url}}/{{value.url}}">{{value.title|raw}}</a></span>
          <span class="comments-count">{{value.total}}</span>
          <span class="votes-count">{{value.total}}</span>
          <span class="date">{{value.date_modified|date('Y-m-d')}}</span>
        </li>
  {%endfor%}
      </ul>
      <!-- pagenation -->
      <div class="pagination-container">
      {%include display.pagination%}
      </div>
      <!-- ./pagenation -->
  {%else%}
      <div class="msg error">{%trans "No Result Found"%}</div>
  {%endif%}

{%endblock%}

{%block check_svg%}
<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M16.667,62.167c3.109,5.55,7.217,10.591,10.926,15.75 c2.614,3.636,5.149,7.519,8.161,10.853c-0.046-0.051,1.959,2.414,2.692,2.343c0.895-0.088,6.958-8.511,6.014-7.3 c5.997-7.695,11.68-15.463,16.931-23.696c6.393-10.025,12.235-20.373,18.104-30.707C82.004,24.988,84.802,20.601,87,16" style="stroke-dasharray: 126.37, 126.37; stroke-dashoffset: 0; transition: stroke-dashoffset 0.2s ease-in-out 0s;"></path></svg>
{%endblock%}

