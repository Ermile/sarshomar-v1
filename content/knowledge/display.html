{%extends display.main%}

{%block content%}
  <aside>
   <div class="group">
     <!-- <div class="full-line-title" data-title='{%trans "question type"%}'></div> -->
     <!-- <div class="full-line-title" id="first-full-line"> -->
       <input type="checkbox" id="question" class="full-line-title">
       <label for="question" data-title='{%trans "question type"%}'></label>
     <!-- </div> -->
     <div class="select-box {%if checkbox.pollgender %}actived{%else%}closed{%endif%}">
      <div class="radio">

        <input id="type1" type="radio" name='pollgender' value="poll" {%if checkbox.pollgender == 'poll' %}checked{%endif%}>
        <label for="type1" class="radio-box"></label>
        <label for="type1">{%trans "Poll"%}</label>
       {%if checkbox.pollgender == 'poll'%}{%endif%}
      </div>
      <div class="radio">
       <input id="type2" type="radio" name='pollgender' value="quiz" {%if checkbox.pollgender == 'quiz' %}checked{%endif%}>
       <label for="type2" class="radio-box"></label>
       <label for="type2">{%trans "quiz"%}</label>
       {%if checkbox.pollgender == 'quiz'%}{%endif%}
      </div>
      <div class="radio">
       <input id="type4" type="radio" name='pollgender' value="survey" {%if checkbox.pollgender == 'survey' %}checked{%endif%}>
       <label for="type4" class="radio-box"></label>
       <label for="type4">{%trans "survey"%}</label>

       {%if checkbox.pollgender == 'survey'%}{%endif%}
      </div>
    </div>
   </div>
   <div class="group">
    <!-- <div class="full-line-title" data-title='{%trans "according to survey"%}'></div> -->
       <input type="checkbox" id="according" class="full-line-title">
       <label for="according" data-title='{%trans "according to survey"%}'></label>

    <div class="select-box closed {%if checkbox.polltype %}actived{%else%}closed{%endif%}">

     <div class="radio">
      <input id="multiplechoice" type="radio" name="polltype" value="multiplechoice" {%if checkbox.polltype == 'multiplechoice' %}checked{%endif%}>
      <label for="multiplechoice" class="radio-box"></label>
      <label for="multiplechoice">{%trans "multiplechoice"%}</label>
      {%if checkbox.polltype == 'multiplechoice'%}{%endif%}
     </div>
     <div class="radio">
      <input id="descriptive" type="radio" name="polltype" value="descriptive" {%if checkbox.polltype == 'descriptive' %}checked{%endif%}>
      <label for="descriptive" class="radio-box"></label>
      <label for="descriptive">{%trans "descriptive"%}</label>
      {%if checkbox.polltype == 'descriptive'%}{%endif%}
     </div>
     <div class="radio">
      <input id="notification" type="radio" name="polltype" value="notification" {%if checkbox.polltype == 'notification' %}checked{%endif%}>
      <label for="notification" class="radio-box"></label>
      <label for="notification">{%trans "notification"%}</label>
      {%if checkbox.polltype == 'notification'%}{%endif%}
     </div>
     <div class="radio">
      <input id="upload" type="radio" name="polltype" value="upload" {%if checkbox.polltype == 'upload' %}checked{%endif%}>
      <label for="upload" class="radio-box"></label>
      <label for="upload">{%trans "upload"%}</label>
      {%if checkbox.polltype == 'upload'%}{%endif%}
     </div>
     <div class="radio">
      <input id="starred" type="radio" name="polltype" value="starred" {%if checkbox.polltype == 'starred' %}checked{%endif%}>
      <label for="starred" class="radio-box"></label>
      <label for="starred">{%trans "starred"%}</label>
      {%if checkbox.polltype == 'starred'%}{%endif%}
     </div>
     <div class="radio">
      <input id="numerical" type="radio" name="polltype" value="numerical" {%if checkbox.polltype == 'numerical' %}checked{%endif%}>
      <label for="numerical" class="radio-box"></label>
      <label for="numerical">{%trans "numerical"%}</label>
      {%if checkbox.polltype == 'numerical'%}{%endif%}
     </div>
     <div class="radio">
      <input id="sort" type="radio" name="polltype" value="sort" {%if checkbox.polltype == 'sort' %}checked{%endif%}>
      <label for="sort" class="radio-box"></label>
      <label for="sort">{%trans "sort"%}</label>
      {%if checkbox.polltype == 'sort'%}{%endif%}
     </div>
    </div>
   </div>
   <div class="group">
    <!-- <div class="full-line-title" data-title='{%trans "survey time"%}'></div> -->
       <input type="checkbox" id="survey" class="full-line-title">
       <label for="survey" data-title='{%trans "survey time"%}''></label>
    <div class="select-box {%if checkbox.status %}actived{%else%}closed{%endif%}">
      <div class="radio">

        <input id="time1" type="radio" name='status' value="publish" {%if checkbox.status == 'publish'%}checked{%endif%}>
        <label for="time1" class="radio-box"></label>
        <label for="time1">{%trans "publish"%}</label>
        {%if checkbox.status == 'publish'%}{%endif%}
      </div>
      <div class="radio">
        <input id="time2" type="radio" name='status' value="expired" {%if checkbox.status == 'expired'%}checked{%endif%}>
        <label for="time2" class="radio-box"></label>
        <label for="time2">{%trans "expire"%}</label>

        {%if checkbox.status == 'expired'%}{%endif%}
      </div>
    </div>
   </div>
   <!-- <div class="group">
    <div class="full-line-title" data-title='{%trans "prize"%}'></div>
    <div class="select-box prize-box ">
      <div class="checkbox" >
       <input id="prize1" type="radio" name='prize'>
       <label for="prize1">{%trans "پاسخ‌دهی"%}</label>
      </div>
      <div class="radio">
       <input id="prize2" type="radio" name='prize'>
       <label for="prize2">{%trans "قرعه‌کشی"%}</label>
      </div>
    </div>
   </div> -->
   <div class="group">
    <!-- <div class="full-line-title" data-title='{%trans "filters"%}'></div> -->
       <input type="checkbox" id="filters" class="full-line-title">
       <label for="filters" data-title='{%trans "filters"%}''></label>

    <div class="select-box filters-box  {%if checkbox.marrital or checkbox.employmentstatus or checkbox.gender or checkbox.graduation or checkbox.country or checkbox.province or checkbox.religion or checkbox.language or checkbox.age %}actived{%else%}closed{%endif%}">

     <div class="options-box">
      <label for="marrital">{%trans "marrital"%}</label>
       <select name="marrital" id="marrital">
        <option value="">{%trans ""%}</option>
        <option value="single" {%if checkbox.marrital == 'single'%}selected{%endif%}>{%trans "single"%}</option>
        <option value="married" {%if checkbox.marrital == 'married'%}selected{%endif%}>{%trans "Married"%}</option>
      </select>
     </div>
     <div class="options-box">
       <label for="employmentstatus">{%trans "employment"%}</label>
       <select name="employmentstatus" id="employmentstatus">
        <option value="">{%trans ""%}</option>
        <option value="employee" {%if checkbox.employmentstatus == 'employee'%}selected{%endif%}>{%trans "employee"%}</option>
        <option value="unemployed" {%if checkbox.employmentstatus == 'unemployed'%}selected{%endif%}>{%trans "Unemployed"%}</option>
        <option value="retired" {%if checkbox.employmentstatus == 'retired'%}selected{%endif%}>{%trans "Retired"%}</option>
       </select>
     </div>
     <div class="options-box">
      <label for="gender">{%trans "gender"%}</label>
      <select name="gender" id="gender">
        <option value="">{%trans ""%}</option>
        <option value="male" {%if checkbox.gender == 'male'%}selected{%endif%}>{%trans "male"%}</option>
        <option value="female" {%if checkbox.gender == 'female'%}selected{%endif%}>{%trans "female"%}</option>
      </select>
     </div>
     <div class="options-box">
      <label for="graduation">{%trans "graduation"%}</label>
      <select name="graduation" id="graduation">
        <option value="">{%trans ""%}</option>
        <option value="illiterate" {%if checkbox.graduation == 'illiterate' %}selected{%endif%} %>{%trans "illiterate"%}</option>
        <option value="undergraduate" {%if checkbox.graduation == 'undergraduate' %}selected{%endif%} %>{%trans "undergraduate"%}</option>
        <option value="graduate" {%if checkbox.graduation == 'graduate' %}selected{%endif%} %>{%trans "graduate"%}</option>
        <option value="under diploma" {%if checkbox.graduation == 'under diploma' %}selected{%endif%} %>{%trans "under diploma"%}</option>
        <option value="diploma" {%if checkbox.graduation == 'diploma' %}selected{%endif%} %>{%trans "diploma"%}</option>
        <option value="2 year college" {%if checkbox.graduation == '2 year college' %}selected{%endif%} %>{%trans "2 year college"%}</option>
        <option value="bachelor" {%if checkbox.graduation == 'bachelor' %}selected{%endif%} %>{%trans "bachelor"%}</option>
        <option value="master" {%if checkbox.graduation == 'master' %}selected{%endif%} %>{%trans "master"%}</option>
        <option value="phd" {%if checkbox.graduation == 'phd' %}selected{%endif%} %>{%trans "phd"%}</option>
        <option value="other" {%if checkbox.graduation == 'other' %}selected{%endif%} %>{%trans "other"%}</option>
      </select>
     </div>
     <div class="options-box">
      <label for="country">{%trans "country"%}</label>
      <input name="country" id="country" value="">
     </div>
     <div class="options-box">
      <label for="age">{%trans "age"%}</label>
      <input name="age" id="age" value="">
     </div>
     <div class="options-box">
      <label for="province">{%trans "province"%}</label>
      <input name="province" id="province" value="">
     </div>
     <div class="options-box">
      <label for="religion">{%trans "religion"%}</label>
      <input name="religion" id="religion" value="">
     </div>
     <div class="options-box">
      <label for="language">{%trans "language"%}</label>
      <input name="language" id="language" value="">
     </div>

    </div>
   </div>
  </aside>

<div class="main">

  <div class="row">
    <div class="span1"></div>
    <div class="span10">
     <div class="search-box">
      <input type="text" name="search" placeholder='{%trans "Search"%}' class="pollsearch" value="{{search_value}}" autocomplete='off'>
      <button class="search-button"><i class="fa fa-search" aria-hidden="true"></i></button>
     </div>
     <div class="search-result" data-xhr='search-result' id="search-result">
       {%include display.result%}

     </div>
    </div><!-- /.span9 -->
  </div>
</div>
{%endblock%}

{%block foot_js%}
<script>
$(document).ready(function()
{

  $("aside input[type='checkbox'].full-line-title").click(function(){
console.log(this);
      var label = $(this).next("aside input[type='checkbox'].full-line-title+label");
      var options_box = label.next(".select-box");
    if ($(this).is(':checked'))
    {
      //add actived and close classes to select-box on aside
      options_box.slideDown(function(){
        if(options_box.is(":visible"))
        {
          options_box.addClass( "actived" );
          options_box.removeClass( "closed" );
        }
        if(options_box.is(":hidden"))
        {
          options_box.addClass( "closed" );
          options_box.removeClass( "actived" );
        }
      });
    }
    else
    {
      //add actived and close classes to select-box on aside
      options_box.slideUp(function(){
        if(options_box.is(":visible"))
        {
          options_box.addClass( "acived" );
          options_box.removeClass( "closed" );
        }
        if(options_box.is(":hidden"))
        {
          options_box.addClass( "closed" );
          options_box.removeClass( "actived" );
        }
      });
    }
    // var title = $(this).next("aside input[type='checkbox'].full-line-title");
  });


 $("aside input[type=checkbox]").click(function(){
  $(this).parent('.ac-custom').toggleClass('selected');
 });

 $(document).on('click', '.star', function(){
   id = $(this).parent('li').attr("data-id");
   _self = $(this);
   $(this).ajaxify(
      {
        ajax:
        {
          data:
          {
            'type': 'faivorites',
            'id': id
          },
          abort: true,
          success: function(e, data, x)
          {
            $(_self).toggleClass("starred");
          },
          method: 'post'
        }
      });
 });

  $(document).on('change', 'select', function(){

    var new_url;
    var url        = window.location.pathname;
    var pattern    = new RegExp( name + '\=([^\/]*)');
    var exist_value_url = null;

    name  = $(this).attr('name');
    value = $(this).val();

    match = url.match(pattern);
    if(match !== null)
    {
      exist_value_url = match[1];
    }

    if(match !== null)
    {
      new_url = url.replace(pattern, name + '=' + value);
    }
    else if(value == '')
    {
      new_url = url.replace(pattern, '');
    }
    else
    {
      if(/\/$/.test(url))
      {
        new_url = url + name + '=' + value;
      }
      else
      {
        new_url = url + '/' + name + '=' + value;
      }
    }
    Navigate({ url: new_url });
  });

//   $(document).on('change', 'input[type=checkbox]', function(){

//     var new_url;
//     var url        = window.location.pathname;
//     var pattern    = new RegExp( name + '\=([^\/]*)');
//     var is_checked = false;
//     var exist_value_url = null;

//     name  = $(this).attr('name');
//     value = $(this).val();

//     match = url.match(pattern);
//     if(match !== null)
//     {
//       exist_value_url = match[1];
//     }
//     if($(this).prop("checked"))
//     {
//       is_checked = false;
//     }
//     else
//     {
//       is_checked = true;
//     }

//     if(is_checked)
//     {
//       new_url = url.replace(pattern, '');
//     }
//     else
//     {
//       if(match !== null)
//       {
//         new_url = url.replace(pattern, name + '=' + value);
//       }
//       else
//       {
//         if(/\/$/.test(url))
//         {
//           new_url = url + name + '=' + value;
//         }
//         else
//         {
//           new_url = url + '/' + name + '=' + value;
//         }
//       }
//     }
//     // console.log(new_url);
//     // console.log(is_checked)
//     Navigate({ url: new_url });
//   });
});

</script>
{%endblock%}


