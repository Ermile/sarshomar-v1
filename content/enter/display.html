{%extends display.mvc%}


{%block head_css%}
 <link rel="stylesheet" type="text/css" href="{{url.static}}css/account.css">
{%endblock%}


{%block body%}
<div class='f login'>
 <div class='c flex f-column justify-center'>
  <div class='fancy'>
   <span>{%trans "Sign Up"%}</span>
  </div>

  <div class="field mobile">
   <label>
    <span>{%trans "Enter Your Mobile Number"%}</span>
    <input type='tel' name='mobile' id='mobile' placeholder='{%trans "Mobile Number"%}' autocomplete='off' maxlength='15' class='ltr'>
   </label>
  </div>

  <div class="notif patient hidden">
   <span>{%trans "Please be patient, we are generating keys"%}</span>
   <div class="notif-loader">
    <span></span>
    <span></span>
    <span></span>
   </div>
  </div>

  <div class="field password hidden">
   <label>
    <span>{%trans "Password"%}</span>
    <input type='password' name='password' id='password' placeholder='{%trans "Password"%}'>
   </label>
  </div>

  <div class="field code hidden">
   <label>
    <span>{%trans "Enter Verification Code"%}</span>
    <input type='number' name='code' id='code' placeholder='_ _ _ _' autocomplete='off' class='center' max='9999'>
   </label>
  </div>

  <div class="notif hidden">
   <span>{%trans "Problems receiving your code?"%}</span>
   <a href="#">{%trans "Login using other ways"%}</a>
  </div>

  <div class="notif correct hidden">
   <span>{%trans "Is this mobile number correct?"%}</span>
   <a href="#">{%trans "Change number"%}</a>
  </div>

  <div class="other-ways hidden">
   <span>{%trans "Other ways"%}</span>
  </div>

  <button id="go">{%trans "Login"%}</button>
 </div>

 <div class='c flex f-column justify-center align-center'>
  <img class='logo' src='{{url.static}}/images/logo/sarshomar-brand.svg' alt=''>
 </div>
</div>
{%endblock%}


{%block foot_js%}
<script type="text/javascript">
var enter1 = function()
{}

var enter2 = function()
{}

var enter3 = function()
{}








function show_error(status)
{
 if (status === undefined)
 {
  status = 'wrong_code';
 }
 switch(status)
 {
  case 'wrong_code':
   $('.notif.correct').hide().removeClass('hidden').fadeIn(300);
   break;
  case 'short_block':
   break;
  case 'long_block':
   break;
  default:
   break;
 }
}

function step_code()
{
 $('.notif.patient').fadeOut(300, function(e) {
  $(this).addClass('hidden');
  $('.field.code').hide().removeClass('hidden').fadeIn(300, function(e) {
   setTimeout(function() {
    $('.other-ways').hide().removeClass('hidden').fadeIn(300);
   }, 3000);
  });
 });
}

function step_wait(time)
{
 // initial validation
 if (time === undefined)
 {
  time = 1000;
 } else {
  time *= 1000;
 }

 // disable mobile field
 $('#mobile').attr('disabled', '');

 // hide button and show patient notif
 $('button').fadeOut(300, function(e) {
  $('.notif.patient').hide().removeClass('hidden').fadeIn(300, function() {
   setTimeout(function() {
    step_code();
   }, time);
  });
 });
}

$(document).on('click', 'button', function(e) {
 step_wait(1);
});

$(document).on('input', '#code', function(e) {
 var len = $(this).val().length;
 if (len === 4)
 {
  $('#code').attr('disabled', '');
  setTimeout(function() {
   show_error('wrong_code');
  }, 1000);
 }
});

</script>
{%endblock%}
