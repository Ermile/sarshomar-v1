{%extends display.main%}

{%block content%}
<div class="main pad">
 <div class="box">
  <section id="poll-box">
   {%if perm.publish_poll.admin%}
   <script type="text/javascript">alert('{%trans "YOU CAN CHANGE THE STATUS OF THIS POLL!"%}');</script>
   {%endif%}
   <h2>{{post.post_title}}</h2>
   {%include template.social%}
   {%if profile%}
   <script type="text/javascript">alert('{%trans "This question will complete your profile"%}')</script>
   {%endif%}
   <p>{{post.post_content}}</p>
   {%if article%}
   <div class="read-more">
    <span>{%trans "Read More"%}</span>
    <a href="{{article.url}}"><span data-hover="{{article.title}}">{{article.title}}</span></a>
   </div>
   {%endif%}
   <form method="post">
   {%if post.post_meta.opt%}{#check post meta exist#}
   <input type="hidden" name="data-id" value="{{post.id}}">
   {%if multiple_choice%}
    <ul>
    {%for key, value in post.post_meta.opt%}
     <li class="ac-custom ac-checkbox ac-checkmark">
      <input type="checkbox" name="{{value.key}}" id="check_{{value.key}}" class="answer-link" data-key="{{value.key}}" value="{{value.txt}}">
      <label for="check_{{value.key}}">{{value.txt}}</label>
     </li>
    {%endfor%}
    {%if descriptive%}
     <li>
      <input type="checkbox" id="check_other" class="answer-link" data-key="opt_{{post.post_meta.opt|length + 1}}" value="other">
      <label for="check_other"><input type="text" name="opt_other"></label>
     </li>
    {%endif%}
    </ul>
   {%else%}{#muliple_choice not set load the radio mod#}
    <ul>
    {%for key, value in post.post_meta.opt%}
     <li class="ac-custom ac-radio ac-fill">
      <input type="radio" name="radio" id="radio_{{value.key}}" class="answer-link" data-key="{{value.key}}" value="{{value.key}}">
      <label for="radio_{{value.key}}">{{value.txt}}</label>
     </li>
    {%endfor%}
    {%if descriptive%}
     <li class="ac-custom ac-radio ac-fill">
      <input type="radio" name="radio" id="radio_other" class="answer-link" data-key="opt_{{post.post_meta.opt|length + 1}}" value="other">
      <label for="radio_other"><input type="text" name="opt_other"></label>
     </li>
    {%endif%}
    </ul>
   {%endif%}{#multiple_choice check end#}
   <input type="submit" name="opt_0" value="skip">
   <div class="buttons">
    <nav class="btn-answers">
     <button class="save-anwser">{%trans "Save Answer"%}</button>
    </nav>
   </div>
   {%else%}{#post.meta not exist, the user answred the poll #}
   <div class="buttons">
    <nav class="btn-answers">
     <button class="save-anwser"><a href="ask"  data-direct style="color:black;">{%trans "Ask Me"%}</a></button>
    </nav>
   </div>
   {%endif%}{#post.meta check#}
   </form>
  </section>

  {%if chart%}
  <div class="row" id="poll-result">
   <div class="type">
    <ul class="tabs">
     {%for key, value in chart%}
      {%if value.categories != 'null'%}
       <li chart-type="{{key}}" class="chart-{{key}} {%if key == 'result'%}active{%endif%}">{{key|trans}}</li>
      {%endif%}
     {%endfor%}
    </ul>
   </div>
   <div class="poll chart"></div>
  </div>
  {%endif%}

  <div class="row" id="poll-extra">
   <h2 class="special-heading">{%trans "Description"%}</h2>
   <div class="span4" id="poll-info">
    {%if date_start or date_end%}
    <div class="title">{%trans "Poll Period"%}</div>
    <div class="period">
     <span class="start-time">{{date_start}}</span>
     <span>{%trans "to"%}</span>
     <span class="end-time">{{date_end}}</span>
    </div>
    {%endif%}

    <div class="title">{%trans "Status"%}</div>
    <div class="status">{{status}}</div>

    {%if tags%}
    <div class="title">{%trans "Keyword"%}</div>
    <div class="tags">{{tags({"html":true})}}</div>
    {%endif%}
   </div>
   <div class="span4" id="poll-filters">
    {%if filters%}
    <div class="title">{%trans "Society Statistics"%}</div>
    <span><i class="fa fa-2x fa-{{value.icon}}" aria-hidden="true"></i> {{value.filter}}</span>
    {%endif%}
   </div>
   <div class="span4" id="poll-similar">
    {%if similar_post()|length > 0%}
    <div class="title">{%trans "Similar Questions"%}</div>
    {%for key, value in similar_post()%}
    <div><a href="{{base.url}}/{{value.url}}">{{value.title}}</a></div>
    {%endfor%}
    {%endif%}
   </div>
  </div>
 </div>
</div>
{%endblock%}

{%block foot_js%}
{%endblock%}
