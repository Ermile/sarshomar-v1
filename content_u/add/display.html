{%extends display.main%}

{%block content%}
<div class="main pad">
  <div class="box">
    <form method="post">
      <input type="hidden" name="poll_type" value="">

      <div class="row auto">
        <div class="span2"></div>
        <div class="span8">
         {%include template.progress%}
          <div class="row">
            <div class="type">
              <ul class="tabs">
                <li data-tab="multiple_choice" class="active"><i class="fa fa-check" aria-hidden="true"></i> <span>{%trans "Multiple Choice"%}</span></li>
                <li data-tab="descriptive"><i class="fa fa-pencil" aria-hidden="true"></i> <span>{%trans "Descriptive"%}</span></li>
                <li data-tab="notification"><i class="fa fa-bell" aria-hidden="true"></i> <span>{%trans "Notification"%}</span></li>
                <li data-tab="upload"><i class="fa fa-upload" aria-hidden="true"></i> <span>{%trans "Upload"%}</span></li>
                <li data-tab="starred"><i class="fa fa-star" aria-hidden="true"></i> <span>{%trans "Starred"%}</span></li>
                <li data-tab="numerical"><i class="fa fa-sitemap" aria-hidden="true"></i> <span>{%trans "Numerical"%}</span></li>
                <li data-tab="sort"><i class="fa fa-sort-amount-desc" aria-hidden="true"></i> <span>{% trans "Sort"%}</span></li>
              </ul>
            </div><!-- /.type -->

            <ul class="tab">
              <li id="tab-multiple_choice" class="active">
                {%if perm.sarshomar_knowledge.add%}
                <div class="element switch">
                  <input type="radio" name="sarshomar_knowledge" id="sarshomar" value="sarshomar" {%if poll %}{%if poll.sarshomar == 1%}checked{%endif%}{%else%}checked{%endif%}>
                  <label for="sarshomar">{%trans "Sarshomar"%}</label>
                  <input type="radio" name="sarshomar_knowledge" id="personal" value="personal"  {%if poll and poll.sarshomar == null%}checked{%endif%}>
                  <label for="personal">{%trans "Personal"%}</label>
                </div>
                {%endif%}

                <div class="element">
                  <label class="title" for="title" autocomplete="off">Title</label>
                  <input class="input" type="text" name="title" id="title" autocomplete="off" value="{{poll.title}}">
                </div>

                  <div class="input-group">
                  {%if answers is iterable%}
                    {%for key, value in answers%}
                    <div class="element small" data-number="{{key + 1}}" data-id="{{value.id}}">
                      <label class="title" for="answer{{key + 1}}">Answer {{key + 1}}</label>
                      <input class="input" type="text" name="{{value.option_key}}" id="answer{{key + 1}}" autocomplete="off" value="{{value.option_value}}" data-id={{value.id}}>
                      <input type="hidden" name="answer_true_{{key + 1}}" value="{{value.meta.true}}">
                      <input type="hidden" name="answer_type_{{key + 1}}" value="{{value.meta.type}}">
                      <span class="fa fa-times delete" aria-hidden="true"></span>
                    </div>
                    {%endfor%}
                  {%else%}{# no answer found #}
                    <div class="element small" data-number="1">
                      <label class="title" for="answer1">Answer 1</label>
                      <input class="input" type="text" name="answers_1" id="answer1" autocomplete="off">
                      <input type="hidden" name="answer_true_1" data-true="true">
                      <input type="hidden" name="answer_type_1" data-type="type" value="text">
                      <span class="fa fa-times delete" aria-hidden="true"></span>
                    </div>

                    <div class="element small" data-number="2">
                      <label class="title" for="answer2">Answer 2</label>
                      <input class="input" type="text" name="answers_2" id="answer2" autocomplete="off">
                      <input type="hidden" name="answer_true_2" data-true="true">
                      <input type="hidden" name="answer_type_2" data-type="type"value="text">
                      <span class="fa fa-times delete" aria-hidden="true"></span>
                    </div>
                  {%endif%}
                  </div><!-- /.input-group -->

                  <div class="row auto">
                    <div class="span6 checkbox-group">
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_descriptive" id="descriptive" {%if poll.meta.descriptive%}checked{%endif%}>
                          <label for="descriptive" class="check-box"></label>
                          <label for="descriptive">{%trans "Descriptive"%}</label>
                        </span>
                      </div>
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_score" id="score" {%if poll.meta.score%}checked{%endif%}>
                          <label for="score" class="check-box"></label>
                          <label for="score">{%trans "Score"%}</label>
                        </span>
                      </div>
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_multiple_choice" id="multiple_choice" {%if poll.meta.multiple_choice%}checked{%endif%}>
                          <label for="multiple_choice" class="check-box"></label>
                          <label for="multiple_choice">{%trans "Multiple Choice"%}</label>
                        </span>
                      </div>
                    {%if perm.hidden_result.admin%}
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_hidden_result" id="hidden_result" {%if poll.meta.hidden_result%}checked{%endif%}>
                          <label for="hidden_result" class="check-box"></label>
                          <label for="hidden_result">{%trans "Hidden Result"%}</label>
                        </span>
                      </div>
                    {%endif%}
                    </div><!-- /.span6 -->

                    <div class="span6 checkbox-group">
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_random_sort" id="random_sort" {%if poll.meta.random_sort%}checked{%endif%}>
                          <label for="random_sort" class="check-box"></label>
                          <label for="random_sort">{%trans "Random Sort"%}</label>
                        </span>
                      </div>
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_true_answer" id="true_answer" {%if poll.meta.true_answer%}checked{%endif%}>
                          <label for="true_answer" class="check-box"></label>
                          <label for="true_answer">{%trans "True Answer"%}</label>
                        </span>
                      </div>
                      <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_comment" id="comment" {%if poll.comment == 'open'%}checked{%endif%}>
                          <label for="comment" class="check-box"></label>
                          <label for="comment">{%trans "Comment"%}</label>
                        </span>
                      </div>
                       <div>
                        <span class="checkbox">
                          <input type="checkbox" name="meta_update_result" id="update_result" {%if poll.meta.update_result %}checked{%endif%}>
                          <label for="update_result" class="check-box"></label>
                          <label for="update_result">{%trans "Update Result"%}</label>
                        </span>
                      </div>
                    </div><!-- /.span6 -->
                  </div><!--/.row-->

                  {% if perm.complete_profile.admin %}
                  <div class="complete-profile">
                    <span class="checkbox">
                      <input type="checkbox" name="pollComplete" id="pollComplete" {%if poll.meta.profile%}checked{%endif%}>
                      <label for="pollComplete" class="check-box"></label>
                      <label for="pollComplete">{%trans "Profile Complete"%}</label>
                    </span>

                    <select class="complete-profile-dropdown" name="meta_profile">
                      <option value="">{%trans "Please Select One Item"%}</option>
                        {%for key, value in profile_lock%}
                          {%set t_value = key %}
                          <option value="{{key}}" data-value="{{value}}">{%trans t_value%}</option>
                        {%endfor%}
                    </select>
                  </div>
                  {%endif%}


                  <input type="hidden" name="parent_tree_id" value="{{poll_tree_id}}">
                  <input type="hidden" name="parent_tree_opt" value="{{poll_tree_opt}}">
                  <div class="tree">
                    <span class="checkbox">
                      <input type="checkbox" name="meta_tree" id="tree" {%if poll_tree_title %}checked{%endif%}>
                      <label for="tree" class="check-box"></label>
                      <label for="tree">{%trans "Tree"%}</label>
                    </span>

                    <div class="tree-extra" {%if poll_tree_title%}style="display: flex;"{%endif%}>
                      <input class="" type="text" id="search" placeholder='{%trans "Search"%}' value="{{poll_tree_title}}">
                      <span class="fa fa-search search" aria-hidden="true"></span>
                      <select class="tree-dropdown" id="repository">
                        <option value="personal" >{%trans "Personal" %}</option>
                        <option value="sarshomar" >{%trans "Sarshomar" %}</option>
                      </select>
                      <div class="tree-list" {%if poll_tree_title%}style="display: block;"{%endif%}>
                        <ul class="questions"></ul>
                      </div>
                    </div>
                  </div>


                  <div class="panel-text">
                    <div class="title">
                      <span><i class="fa fa-plus" aria-hidden="true"></i> Summary</span>
                    </div>
                    <textarea name="summary">{{poll.meta.desc}}</textarea>
                  </div>

                  <div class="panel-text">
                    <div class="title">
                      <span><i class="fa fa-plus" aria-hidden="true"></i> Description</span>
                    </div>
                    <textarea name="description">{{poll.content}}</textarea>
                  </div>
              </li><!-- /#tab-multiple_choice -->

              <li id="tab-descriptive">
                <!-- <div class="element">
                  <label class="title" for="title">{%trans "Title"%}</label>
                  <input class="input" type="text" name="title" id="title" value="{{poll.title}}" autocomplete="off">
                </div>

                <div autocomplete="off">
                  <ul>
                    <li>
                      <input type="checkbox" name="meta_score" id="score" {%if poll.meta.score%}checked{%endif%}>
                      <label for="score">{%trans "Score"%}</label>
                    </li>
                  </ul>
                </div>

                {% if perm.complete_profile.admin %}
                <div class="complete-profile">
                  <span>
                    <input class="" type="checkbox" name="pollComplete" id="pollComplete" {%if poll.meta.profile%}checked{%endif%}>
                    <label for="pollComplete">{%trans "Profile"%}</label>
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"></svg>
                  </span>
                  <select class="complete-profile-dropdown" name="meta_profile">
                    <option value="">{%trans "Please Select One Item"%}</option>
                      {%for key, value in profile_lock%}
                        {%set t_value = key %}
                        <option value="{{key}}" data-value="{{value}}">{%trans t_value%}</option>
                      {%endfor%}
                  </select>
                </div>
                {%endif%}

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Summary</span>
                  </div>
                  <textarea name="summary">{{poll.meta.desc}}</textarea>
                </div>

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Description</span>
                  </div>
                  <textarea name="description">{{poll.content}}</textarea>
                </div> -->
              </li><!-- /#tab-descriptive -->

              <li id="tab-notification">
                <!-- <div class="element">
                  <label class="title" for="title">{%trans "Title"%}</label>
                  <input class="input" type="text" name="title" id="title" value="{{poll.title}}" autocomplete="off">
                </div>

                <input type="hidden" name="parent_tree_id" value="{{poll_tree_id}}">
                <input type="hidden" name="parent_tree_opt" value="{{poll_tree_opt}}">
                <div class="tree">
                  <span>
                    <input class="" type="checkbox" name="meta_tree" id="tree" {%if poll_tree_title %}checked{%endif%}>
                    <label for="tree">{%trans "Tree"%}</label>
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"></svg>

                  </span>
                  <div class="stuff" {%if poll_tree_title%}style="display: flex;"{%endif%}>
                    <input class="" type="text" id="search" placeholder='{%trans "Search"%}' value="{{poll_tree_title}}">
                    <span class="fa fa-search search" aria-hidden="true"></span>
                    <select class="tree-dropdown" id="repository">
                      <option value="personal" >{%trans "Personal" %}</option>
                      <option value="sarshomar" >{%trans "Sarshomar" %}</option>
                    </select>
                  </div>
                </div>
                <div class="tree-list" {%if poll_tree_title%}style="display: block;"{%endif%}>
                  <ul class="questions"></ul>
                </div>

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Summary</span>
                  </div>
                  <textarea name="summary">{{poll.meta.desc}}</textarea>
                </div>

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Description</span>
                  </div>
                  <textarea name="description">{{poll.content}}</textarea>
                </div> -->
              </li><!-- /#tab-notification -->

              <li id="tab-upload">upload</li>
              <li id="tab-starred">starred</li>
              <li id="tab-numerical">numerical</li>
              <li id="tab-sort">sort</li>
            </ul><!-- /.tab -->
          </div><!-- /.row -->

        </div><!-- /.span8 -->

        <div class="btn-container center">
          <input type="hidden" name="n" value="v" id="submit-form">
          <nav>
            <button class="btn" send-name="filter" value="filter">{%trans "Filter And Publish"%}</button>
          {%if survey_mod%}
            <button class="primary btn" send-name="add_poll" value="add_poll">{%trans "Add Poll"%}</button>
          {%else%}
            <button class="primary btn" send-name="survey" value="survey">{%trans "Add Poll"%}</button>
          {%endif%}
          </nav>
        </div><!-- /.btn-container -->

        <div class="span4">
          <div class="row">
            {%if poll_list %}
            <div class="group">
              <div class="title-line"><span>Survey</span></div>
              <div class="element small">
                <label class="title" for="secondary-title">Title</label>
                <input class="input" type="text" name="secondary-title" id="secondary-title" autocomplete="off">
              </div>
            </div>

            <div class="group">
              <div class="title-line"><span>Questions List</span></div>
              {%for key, value in poll_list%}
              <!-- <a href="{{base.url}}/{{value.url}}?preview=yes"> -->
                <div class="element small has-floating">
                  <label class="title" for="question{{key + 1}}">Question {{key + 1}}</label>
                  <input class="input" type="text" name="question{{key + 1}}" id="question{{key + 1}}" value="{{value.title}}" autocomplete="off">
                  <span class="addon floating">
                    <span><i class="fa fa-check" aria-hidden="true"></i></span>
                  </span>
                </div>
              <!-- </a> -->
              {%endfor%}
            </div>
            {%endif%}
          </div><!-- /.row -->
        </div><!-- /.span4 -->
      </div><!-- /.row.auto -->
    </form>
  </div>
</div>
{%endblock%}

{%block foot_js%}
<script type="text/javascript">
  $('.page-progress a').click(function(){
    if($(this).attr('href') == '')
    {
      send_name = $(this).attr('send-name');
      if(send_name == 'add')
      {
        return false;
      }
      $('button[send-name='+ send_name + ']').click();
    }
  });
</script>
{%endblock%}
