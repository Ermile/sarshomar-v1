{%extends display.main%}

{%block content%}
<div class="box">
  <form method="post">
    <input type="hidden" name="poll_type" value="">

    <div class="row auto padding-large">
      <div class="span8">
        <div class="row">
          <div class="type">
            <ul class="tabs">
              <li data-tab="multiple_choice" class="active"><i class="fa fa-check" aria-hidden="true"></i> <span>{%trans "Multiple Choice"%}</span></li>
              <li data-tab="descriptive"><i class="fa fa-pencil" aria-hidden="true"></i> <span>{%trans "Descriptive"%}</span></li>
              <li data-tab="notification"><i class="fa fa-bell" aria-hidden="true"></i> <span>{%trans "Notification"%}</span></li>
              <li data-tab="upload"><i class="fa fa-upload" aria-hidden="true"></i> <span>{%trans "Upload"%}</span></li>
              <li data-tab="starred"><i class="fa fa-star" aria-hidden="true"></i> <span>{%trans "Starred"%}</span></li>
              <li data-tab="numerical"><i class="fa fa-sitemap" aria-hidden="true"></i> <span>{%trans "Numerical"%}</span></li>
              <li data-tab="sort"><i class="fa fa-sort-amount-desc" aria-hidden="true"></i> <span>{% trans "Sort"%}</span></li>
            </ul>
          </div><!-- /.type -->

          <ul class="tab">
            <li id="tab-multiple_choice" class="active">
              {%if perm.sarshomar_knowledge.add%}
              <div class="element switch">
                <input type="radio" name="sarshomar_knowledge" id="sarshomar" value="sarshomar" {%if poll %}{%if poll.sarshomar == 1%}checked{%endif%}{%else%}checked{%endif%}>
                <label for="sarshomar">{%trans "Sarshomar"%}</label>
                <input type="radio" name="sarshomar_knowledge" id="personal" value="personal"  {%if poll and poll.sarshomar == null%}checked{%endif%}>
                <label for="personal">{%trans "Personal"%}</label>
              </div>
              {%endif%}

              <div class="element">
                <label class="title" for="title" autocomplete="off">Title</label>
                <input class="input" type="text" name="title" id="title" autocomplete="off" value="{{poll.title}}">
              </div>

                <div class="input-group">
                {%if answers is iterable%}
                  {%for key, value in answers%}
                  <div class="element small" data-number="{{key + 1}}" data-id="{{value.id}}">
                    <label class="title" for="answer{{key + 1}}">Answer {{key + 1}}</label>
                    <input class="input" type="text" name="{{value.option_key}}" id="answer{{key + 1}}" autocomplete="off" value="{{value.option_value}}" data-id={{value.id}}>
                    <input type="hidden" name="answer_true_{{key + 1}}" value="{{value.meta.true}}">
                    <input type="hidden" name="answer_type_{{key + 1}}" value="{{value.meta.type}}">
                    <span class="fa fa-times delete" aria-hidden="true"></span>
                  </div>
                  {%endfor%}
                {%else%}{# no answer found #}
                  <div class="element small" data-number="1">
                    <label class="title" for="answer1">Answer 1</label>
                    <input class="input" type="text" name="answers_1" id="answer1" autocomplete="off">
                    <input type="hidden" name="answer_true_1" data-true="true">
                    <input type="hidden" name="answer_type_1" data-type="type" value="text">
                    <span class="fa fa-times delete" aria-hidden="true"></span>
                  </div>

                  <div class="element small" data-number="2">
                    <label class="title" for="answer2">Answer 2</label>
                    <input class="input" type="text" name="answers_2" id="answer2" autocomplete="off">
                    <input type="hidden" name="answer_true_2" data-true="true">
                    <input type="hidden" name="answer_type_2" data-type="type"value="text">
                    <span class="fa fa-times delete" aria-hidden="true"></span>
                  </div>
                {%endif%}
                </div><!-- /.input-group -->

                <div class="row auto element-checkbox">
                  <div class="span6">
                    <div autocomplete="off">
                      <ul>
                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_descriptive" id="descriptive" {%if poll.meta.descriptive%}checked{%endif%}>
                          <label for="descriptive">{%trans "Descriptive Answer"%}</label>
                          {%if poll.meta.descriptive%}{{block('check_svg')}}{%endif%}
                        </li>

                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_score" id="score" {%if poll.meta.score%}checked{%endif%}>
                          <label for="score">{%trans "Score"%}</label>
                          {%if poll.meta.score%}{{block('check_svg')}}{%endif%}
                        </li>

                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_multiple_choice" id="multiple_choice" {%if poll.meta.multiple_choice%}checked{%endif%}>
                          <label for="multiple_choice">{%trans "Multiple Choice"%}</label>
                          {%if poll.meta.multiple_choice%}{{block('check_svg')}}{%endif%}
                        </li>

                        {%if perm.hidden_result.admin%}
                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_hidden_result" id="hidden_result" {%if poll.meta.hidden_result%}checked{%endif%}>
                          <label for="hidden_result">{%trans "Hidden Result"%}</label>
                          {%if poll.meta.hidden_result%}{{block('check_svg')}}{%endif%}
                        </li>
                        {%endif%}
                      </ul>

                    </div>
                  </div>
                  <div class="span6">
                    <div autocomplete="off">
                      <ul>
                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_random_sort" id="random_sort" {%if poll.meta.random_sort%}checked{%endif%}>
                          <label for="random_sort">{%trans "Random Sort"%}</label>
                          {%if poll.meta.random_sort%}{{block('check_svg')}}{%endif%}
                        </li>

                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_true_answer" id="true_answer" {%if poll.meta.true_answer%}checked{%endif%}>
                          <label for="true_answer">{%trans "True Answer"%}</label>
                          {%if poll.meta.true_answer%}{{block('check_svg')}}{%endif%}
                        </li>

                        <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_tree" id="poll_tree" {%if poll.meta.tree%}checked{%endif%}>
                          <label for="poll_tree">{%trans "Poll Tree"%}</label>
                          {%if poll.meta.tree%}{{block('check_svg')}}{%endif%}
                        </li>

                         <li class="ac-custom ac-checkbox ac-checkmark">
                          <input type="checkbox" name="meta_comment" id="comment" {%if poll.comment == 'open'%}checked{%endif%}>
                          <label for="comment">{%trans "Comment"%}</label>
                          {%if poll.comment == 'open'%}{{block('check_svg')}}{%endif%}
                        </li>
                      </ul>
                    </div>
                  </div><!-- /.span6 -->
                </div><!--/.row-->

                {% if perm.complete_profile.admin %}
                <div class="poll-complete">
                  <span class="ac-custom ac-checkbox ac-checkmark">
                    <input class="" type="checkbox" name="pollComplete" id="pollComplete" {%if poll.meta.profile%}checked{%endif%}>
                    <label for="pollComplete">{%trans "Profile"%}</label>
                    {%if poll.meta.profile%}{{block('check_svg')}}{%endif%}
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"></svg>
                  </span>
                  <select class="poll-complete-dropdown" name="meta_profile">
                    <option value="">{%trans "Please Select One Item"%}</option>
                      {%for key, value in profile_lock%}
                        {%set t_value = value %}
                        <option value="{{value}}">{%trans t_value%}</option>
                      {%endfor%}
                  </select>
                </div>
                {%endif%}
                <input type="hidden" name="parent_tree_id" value="">
                <input type="hidden" name="parent_tree_opt" value="">
                <div class="tree">
                  <span class="ac-custom ac-checkbox ac-checkmark">
                    <input class="" type="checkbox" name="tree" id="tree">
                    <label for="tree">{%trans "Tree"%}</label>
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"></svg>
                  </span>
                  <input class="" type="text" id="search" placeholder='{%trans "Search"%}'>
                  <span class="fa fa-search search" aria-hidden="true"></span>
                  <select class="tree-dropdown" id="repository">
                    <option value="personal" >{%trans "Personal" %}</option>
                    <option value="sarshomar" >{%trans "Sarshomar" %}</option>
                  </select>
                </div>
                <div class="tree-list">
                  <ul class="questions"></ul>
                </div>

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Summary</span>
                  </div>
                  <textarea name="summary">{{poll.meta.desc}}</textarea>
                </div>

                <div class="panel-text">
                  <div class="title">
                    <span><i class="fa fa-plus" aria-hidden="true"></i> Description</span>
                  </div>
                  <textarea name="description">{{poll.content}}</textarea>
                </div>

            </li><!-- /#tab-multiple_choice -->
            <li id="tab-descriptive">descriptive</li>
            <li id="tab-notification">notification</li>
            <li id="tab-upload">upload</li>
            <li id="tab-starred">starred</li>
            <li id="tab-numerical">numerical</li>
            <li id="tab-sort">sort</li>
          </ul><!-- /.tab -->
        </div><!-- /.row -->

        <div class="buttons">
          <input type="hidden" name="n" value="v" id="submit-form">
          <nav>
            <button send-name="filter" value="filter">{%trans "Filter"%}</button>
          {%if survey_mod%}
            <button send-name="add_poll" value="add_poll">{%trans "Add Poll"%}</button>
          {%else%}
            <button send-name="survey" value="survey">{%trans "Survey"%}</button>
          {%endif%}
            <button send-name="publish" value="publish">{%trans "Publish"%}</button>
          </nav>
        </div><!-- /.buttons -->
      </div><!-- /.span8 -->

      <div class="span4">
        <div class="row">
          {%if poll_list %}
          <div class="group">
            <div class="title-line"><span>Survey</span></div>
            <div class="element small">
              <label class="title" for="secondary-title">Title</label>
              <input class="input" type="text" name="secondary-title" id="secondary-title" autocomplete="off">
            </div>
          </div>

          <div class="group">
            <div class="title-line"><span>Questions List</span></div>
            {%for key, value in poll_list%}
            <!-- <a href="{{base.url}}/{{value.url}}?preview=yes"> -->
              <div class="element small has-floating">
                <label class="title" for="question{{key + 1}}">Question {{key + 1}}</label>
                <input class="input" type="text" name="question{{key + 1}}" id="question{{key + 1}}" value="{{value.title}}" autocomplete="off">
                <span class="addon floating">
                  <span><i class="fa fa-check" aria-hidden="true"></i></span>
                </span>
              </div>
            <!-- </a> -->
            {%endfor%}
          </div>
          {%endif%}
        </div><!-- /.row -->
      </div><!-- /.span4 -->
    </div><!-- /.row.auto -->
  </form>
</div>
{%endblock%}

{%block foot_js%}
<script type="text/javascript" src="/static/js/svgcheckbox.js"></script>
{%endblock%}

{%block check_svg%}
<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M16.667,62.167c3.109,5.55,7.217,10.591,10.926,15.75 c2.614,3.636,5.149,7.519,8.161,10.853c-0.046-0.051,1.959,2.414,2.692,2.343c0.895-0.088,6.958-8.511,6.014-7.3 c5.997-7.695,11.68-15.463,16.931-23.696c6.393-10.025,12.235-20.373,18.104-30.707C82.004,24.988,84.802,20.601,87,16" style="stroke-dasharray: 126.37, 126.37; stroke-dashoffset: 0; transition: stroke-dashoffset 0.2s ease-in-out 0s;"></path></svg>
{%endblock%}