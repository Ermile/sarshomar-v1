{%extends display.mvc%}

{% block head_css %}
<link rel="stylesheet"       href="https://code.ermile.com/css/ermile-10.1.0.css">
<link rel="stylesheet"       href="{{url.static}}{{'css/style-election.css' | filemtime(true)}}">
{% endblock %}



{%block content%}
 {%if site.currentlang == 'en'%}
  {%set election_title%}{{result.election.en_title}}{%endset%}
 {%else%}
  {%set election_title%}{{result.election.title}}{%endset%}
 {%endif%}

 <div class="box-top">
  {{block('live')}}
  {{block('winner')}}
  {{block('rivals')}}
  {{block('electionUpdate')}}
 </div>
 <div class="container">
  {{block('candidates')}}
  {{block('result')}}
  {{block('province_result')}}
  {{block('city_result')}}
  {{block('time_line')}}
 </div>
{% endblock %}



{%block winner%}
{%if result.election.status == 'done' and result.election.win%}
 {%for key, value in result.candida%}
 {%if value.id == result.election.win%}
  {%if site.currentlang == 'en'%}
  {%set winner%}{{value.en_name}} {{value.en_fame}}{%endset%}
  {%else%}
  {%set winner%}{{value.name}} {{value.fame}}{%endset%}
  {%endif%}

  <div class="container">
   <div class="top-one">
    <div class="image{%if result.election.status == 'done'%} round medium{%endif%}">
     {%if value.win_url%}
      <img src="{{url.static}}{{value.win_url}}" alt="{{winner}}">
     {%elseif result.candida[result.election.win - 1]['file_url_2']%}
      <img src="{{url.static}}{{value.file_url_2}}" alt="{{winner}}">
     {%else%}
      <img src="{{url.static}}{{value.file_url}}" alt="{{winner}}">
     {%endif%}
    </div>
    <h2>{{winner}}</h2>
    <h3>{%trans "President-elect of"%} {{election_title}}</h3>
   </div>
  </div>

 {%endif%}
 {%endfor%}
{%endif%}
{%endblock%}



{%block rivals%}
 <div class="container">
  <div class="top-two">

   {%if site.currentlang == 'en' and result.election.en_title%}
    <h2>{{result.election.en_title}}</h2>
   {%elseif site.currentlang == 'fa' and result.election.title%}
    <h2>{{result.election.title}}</h2>
   {%endif%}

   {%if result.rival%}
   <div class="flex justify-between top-two-container">
    <div class="flex align-end first candidate">
     {% if result.rival[0]['file_url'] %}
     <div class="image{%if result.election.status == 'done'%} round medium{%endif%}"><img src="{{url.static}}{{result.rival[0]['file_url']}}" alt="{{result.rival[0]['name']}} {{result.rival[0]['family']}}"></div>
     {% endif %}
     <div class="data flex f-column align-center justify-end">

      {% if site.currentlang == 'en' %}
       {% if result.rival[0]['en_fame'] %}
        <h4>{{result.rival[0]['en_fame']}}</h4>
       {% elseif result.rival[0]['en_family'] %}
        <h4>{{result.rival[0]['en_family']}}</h4>
       {% else %}
        <h4>-</h4>
       {% endif %}
      {% else %}
       {% if result.rival[0]['fame'] %}
        <h4>{{result.rival[0]['fame']}}</h4>
       {% else %}
        <h4>{{result.rival[0]['family']}}</h4>
       {% endif %}
      {% endif %}

      {% if result.rival[0]['percent'] %}
       <div class="vote-count">{{result.rival[0]['percent']|fitNumber}}%</div>
      {% endif %}
     </div>
    </div>

    <div class="flex align-end second candidate">
     <div class="data flex f-column align-center justify-end">
      {% if site.currentlang == 'en' %}
       {% if result.rival[1]['en_fame'] %}
        <h4>{{result.rival[1]['en_fame']}}</h4>
       {% elseif result.rival[1]['en_family'] %}
        <h4>{{result.rival[1]['en_family']}}</h4>
       {% else %}
        <h4>-</h4>
       {% endif %}
      {% else %}
       {% if result.rival[1]['fame'] %}
        <h4>{{result.rival[1]['fame']}}</h4>
       {% else %}
        <h4>{{result.rival[1]['family']}}</h4>
       {% endif %}
      {% endif %}

      {% if result.rival[1]['percent'] %}
       <div class="vote-count">{{result.rival[1]['percent']|fitNumber}}%</div>
      {%else%}
       <div class="vote-count">-</div>
      {% endif %}
     </div>

     {% if result.rival[1]['file_url'] %}
      <div class="image{%if result.election.status == 'done'%} round medium{%endif%}"><img src="{{url.static}}{{result.rival[1]['file_url']}}" alt="{{result.rival[0]['name']}} {{result.rival[0]['family']}}"></div>
     {% endif %}
    </div>
   </div>

   {% if result.rival[0]['total'] and result.rival[1]['total'] %}
   <div class="status-bar-box">
    <div class="flex justify-between status-bar">
     {% if result.rival[0]['total'] %}
     <div class="first" style="width:{{result.rival[0]['percent']}}%">
      <div class="percentage">
       <span>{{result.rival[0]['total']|number_format|fitNumber}}</span>
      </div>
     </div>
     {% endif %}
     {% if result.rival[1]['total'] %}
     <div class="second" style="width:{{result.rival[1]['percent']}}%">
      <div class="percentage">
       <span>{{result.rival[1]['total']|number_format|fitNumber}}</span>
      </div>
     </div>
     {% endif %}
    </div>
    <div class="indicator"></div>
   </div>
   {% endif %}
{%endif%}
  </div>
 </div>
{%endblock%}



{%block electionUpdate%}
<div class="election-update">
 <span>({%trans "Last Update"%} {{result.result[0]['report_date']|sdate()}})</span>
</div>
{%endblock%}



{%block live%}
{%if result.election.status == 'done'%}
 <div class="live">
  <i></i>
  <span class="title">{%trans "Live Converage"%}</span>
 </div>
{%endif%}
{%endblock%}



{%block candidates%}
{%if result.result%}{%else%}
 {%if result.candida%}
  <div class="election-tbl" id="candidates">
   {%for key, value in result.candida%}
    {%if site.currentlang == 'en'%}
     <div class="f">
      <div class="c2 all-center">
       <div class="image">
        <img src="{{url.static}}{{value.file_url}}" alt="">
       </div>
      </div>
      <div class="c2 vertical-center">
       <span class="first-name">{{value.en_name}}</span>
       <span class="last-name">{%if value.en_fame%}{{value.en_fame}}{%else%}{{value.en_family}}{%endif%}</span>
      </div>
      <div class="c6 all-center">
       <div class="percentage-container">
        <div class="percentage-value">0%</div>
        <div class="percentage-bar">
         <div class="percentage-progress" style="width:0%"></div>
        </div>
       </div>
      </div>
      <div class="c2 all-center">
       <div class="vote-count">{{0|fitNumber}} {%trans "Votes"%}</div>
      </div>
     </div>
    {%else%}
     <div class="f">
      <div class="c2 all-center">
       <div class="image">
        <img src="{{url.static}}{{value.file_url}}" alt="">
       </div>
      </div>
      <div class="c2 vertical-center">
       <span class="first-name">{{value.name}}</span>
       <span class="last-name">{%if value.fame%}{{value.fame}}{%else%}{{value.family}}{%endif%}</span>
      </div>
      <div class="c6 all-center">
       <div class="percentage-container">
        <div class="percentage-value">0%</div>
        <div class="percentage-bar">
         <div class="percentage-progress" style="width:0%"></div>
        </div>
       </div>
      </div>
      <div class="c2 all-center">
       <div class="vote-count">{{0|fitNumber}} {%trans "Votes"%}</div>
      </div>
     </div>
    {%endif%}
   {%endfor%}
  </div>
 {%endif%}
{%endif%}
{%endblock%}



{%block result%}
{%if result.result%}
  <div class="election-tbl" id="total-result">
   {%for key, value in result.result%}
    {%if site.currentlang == 'en'%}
     <div class="f">
      <div class="c2 all-center">
       <div class="image{%if result.election.status == 'done'%} round low{%endif%}">
        <img src="{{url.static}}{{value.file_url}}" alt="">
       </div>
      </div>
      <div class="c2 vertical-center">
       <span class="first-name">{{value.en_name}}</span>
       <span class="last-name">{%if value.en_fame%}{{value.en_fame}}{%else%}{{value.en_family}}{%endif%}</span>
      </div>
      <div class="c6 all-center">
       <div class="percentage-container">
        <div class="percentage-value">{{value.percent|fitNumber}}%</div>
        <div class="percentage-bar">
         <div class="percentage-progress" style="width:{{value.percent}}%"></div>
        </div>
       </div>
      </div>
      <div class="c2 all-center">
       <div class="vote-count">{{value.total|number_format|fitNumber}} {%trans "Votes"%}</div>
      </div>
     </div>
    {%else%}
     <div class="f">
      <div class="c2 all-center">
       <div class="image{%if result.election.status == 'done'%} round low{%endif%}">
        <img src="{{url.static}}{{value.file_url}}" alt="">
       </div>
      </div>
      <div class="c2 vertical-center">
       <span class="first-name">{{value.name}}</span>
       <span class="last-name">{%if value.fame%}{{value.fame}}{%else%}{{value.family}}{%endif%}</span>
      </div>
      <div class="c6 all-center">
       <div class="percentage-container">
        <div class="percentage-value">{{value.percent|fitNumber}}%</div>
        <div class="percentage-bar">
         <div class="percentage-progress" style="width:{{value.percent}}%"></div>
        </div>
       </div>
      </div>
      <div class="c2 all-center">
       <div class="vote-count">{{value.total|number_format|fitNumber}} {%trans "Votes"%}</div>
      </div>
     </div>
    {%endif%}
   {%endfor%}
  </div>
{%endif%}
{%endblock%}



{%block province_result%}
{% if result.result_by_city.province %}
<p class="d-title">{% trans "Candidates Votes on Provinces" %}</p>
<div class="election-tbl" id="place-results">
 <div class="f th">
  <div class="c">{%trans "Province"%}</div>
  {%for k, v in result.candida_id%}
  <div class="c">{{v}}</div>
  {%endfor%}
 </div>
  {%for key, value in result.result_by_city.province%}
   <div class="f">
    <div class="c">{{value.location.local_name}}</div>
    {%for k, v in value.data%}
     <div class="c">{{v|fitNumber}}</div>
    {%endfor%}
   </div>
  {%endfor%}
</div>
{% endif %}
{%endblock%}



{%block city_result%}
{% if result.result_by_city.city %}
<p class="d-title">{% trans "Candidates Votes on Cities" %}</p>
<div class="election-tbl" id="place-results">
 <div class="f th">
  <div class="c">{%trans "City"%}</div>
  {%for k, v in result.candida_id%}
  <div class="c">{{v}}</div>
  {%endfor%}
  </div>
  {%for key, value in result.result_by_city.city%}
  <div class="f">
  <div class="c">{{value.location.local_name}}</div>
  {%for k, v in value.data%}
  <div class="c">{{v|fitNumber}}</div>
  {%endfor%}
  </div>
  {%endfor%}
 </div>
{% endif %}
{%endblock%}



{%block senario%}
{%if result.senario%}
 <div class="chart" id="" data-vals='[{"key"":۱۳۹۶-۰۲-۰۶","value":2},{"key":"۱۳۹۶-۰۲-۰۳","value":3}]' style="width:100%;direction:ltr;height: 300px;margin-bottom: 5em"></div>
{%endif%}
{%endblock%}



{%block time_line%}
{%if result.time_line%}

 <div class="timeline-box">
  <div class="timeline flex justify-around">
{%for key, value in result.time_line%}
   <a href="#">
    <div class="image round low">
     <img src="{{url.static}}{{value.file_url}}" alt="">
    </div>
    <div class="info">{%if site.currentlang == 'en'%}{{value.en_name}}<br>{{value.en_fame}}{%else%}{{value.name}}<br>{{value.fame}}{%endif%}</div>
   </a>
{%endfor%}
  </div>
 </div>

{%endif%}
{%endblock%}
