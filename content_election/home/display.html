{%extends display.mvc%}

{% block head_css %}
<link rel="stylesheet"       href="{{url.static}}{{'css/style-election.css' | filemtime(true)}}">
{% if url.tld == 'dev' %}
<link rel="stylesheet"       href="http://code.ermile.com/css/ermile-10.1.0.css">
{% else %}
<link rel="stylesheet"       href="http://code.ermile.com/css/ermile-10.1.0.css">
{% endif %}
{% endblock %}

{% block content %}
 <div class="box-top">
  {{block('win')}}
  {{block('toolbox')}}
  {{block('rivals')}}
 </div>
 <div class="container">
  {{block('result')}}
  {{block('province_result')}}
  {{block('city_result')}}
  {{block('time_line')}}
 </div>
{% endblock %}

{%block win%}
 {% if result.election.status == 'done' %}
 <div class="top-one">
  <div class="image">

   {% if result.candida[result.election.win - 1]['win_url'] %}
      <img src="{{url.static}}{{result.candida[result.election.win - 1]['win_url']}}" alt="{{result.candida[result.election.win - 1]['name']}} {{result.candida[result.election.win - 1]['fame']}}">
   {% elseif result.candida[result.election.win - 1]['file_url_2'] %}
      <img src="{{url.static}}{{result.candida[result.election.win - 1]['file_url_2']}}" alt="{{result.candida[result.election.win - 1]['name']}} {{result.candida[result.election.win - 1]['fame']}}">
   {% else %}
      <img src="{{url.static}}{{result.candida[result.election.win - 1]['file_url']}}" alt="{{result.candida[result.election.win - 1]['name']}} {{result.candida[result.election.win - 1]['fame']}}">
   {% endif %}

  </div>
  <h2>{{result.candida[result.election.win - 1]['name']}} {{result.candida[result.election.win - 1]['fame']}}</h2>
  <h3>{% trans "President-elect of" %} {{result.election.title}}</h3>
 </div>
 {% endif %}
{%endblock%}

{%block rivals%}
 <div class="top-two">
  <div class="container">
   {% if result.election.title %}<p>{{result.election.title}}</p>{% endif %}
   <div class="flex justify-between top-two-container">
    <div class="flex align-end first candidate">
     {% if result.rival[0]['file_url'] %}
     <div class="image"><img src="{{url.static}}{{result.rival[0]['file_url']}}" alt="{{result.rival[0]['name']}} {{result.rival[0]['family']}}"></div>
     {% endif %}
     <div class="data flex f-column align-center justify-end">
      {% if result.rival[0]['fame'] %}
       <h4>{{result.rival[0]['fame']}}</h4>
      {% else %}
       <h4>{{result.rival[0]['family']}}</h4>
      {% endif %}
      {% if result.rival[0]['percent'] %}
       <div class="vote-count">{{result.rival[0]['percent']|fitNumber}}%</div>
      {% endif %}
     </div>
    </div>

    <div class="flex align-end second candidate">
     <div class="data flex f-column align-center justify-end">
      {% if result.rival[1]['fame'] %}
       <h4>{{result.rival[1]['fame']}}</h4>
      {% else %}
       <h4>{{result.rival[1]['family']}}</h4>
      {% endif %}
      {% if result.rival[1]['percent'] %}
       <div class="vote-count">{{result.rival[1]['percent']|fitNumber}}%</div>
      {% endif %}
     </div>
     {% if result.rival[1]['file_url'] %}
      <div class="image"><img src="{{url.static}}{{result.rival[1]['file_url']}}" alt="{{result.rival[0]['name']}} {{result.rival[0]['family']}}"></div>
     {% endif %}
    </div>
   </div>

   {% if result.rival[0]['total'] and result.rival[1]['total'] %}
   <div class="flex justify-between status-bar">
    {% if result.rival[0]['total'] %}
    <div class="first" style="width:{{result.rival[0]['percent']}}%">
     <div class="percentage">
      <span>{{result.rival[0]['total']|number_format|fitNumber}}</span>
     </div>
    </div>
    {% endif %}
    {% if result.rival[1]['total'] %}
    <div class="second" style="width:{{result.rival[1]['percent']}}%">
     <div class="percentage">
      <span>{{result.rival[1]['total']|number_format|fitNumber}}</span>
     </div>
    </div>
    {% endif %}
    <div class="indicator"></div>
   </div>
   {% endif %}

  </div>
 </div>
{%endblock%}

{% block toolbox %}
<div class="container">
 <div class="flex justify-between toolbox">
  <div class="live">
   {% if result.election.status == 'running' %}
   <i></i>
   <span class="title">{% trans "Live Converage" %}</span>
   {% endif %}
   <span class="last-update">({% trans "Last Update" %} {{result.result[0]['report_date']|sdate()}})</span>
  </div>
 </div>
</div>
{% endblock %}

{%block result%}
{%if result%}
 <p class="d-title">{% trans "Candidates' List" %}</p>
 <div class="candidates">
  {%for key, value in result.result%}
   <div class="candidate">
    <div class="f">
     <div class="c1 flex align-center">
      <div class="image">
       <img src="{{url.static}}{{value.file_url}}" alt="">
      </div>
     </div>
     <div class="c2 name">
      <span>{{value.name}}</span>
      <span class="bold">{{value.family}}</span>
     </div>
     <div class="c7 bar-container">
      <div class="bar-percent">{{value.percent|fitNumber}}%</div>
      <div class="bar">
       <div class="bar-progress" style="width: {{value.percent}}%"></div>
      </div>
     </div>
     <div class="c2 votes-container">
      <span>{{value.total|number_format|fitNumber}}</span>
     </div>
    </div>
   </div>
  {%endfor%}
 </div>
{%endif%}
{%endblock%}


{%block province_result%}
{% if result.result_by_city.province %}
<p class="d-title">{% trans "Candidates' Votes on Provinces" %}</p>
<div class="city-results">
 <div class="f header">
  <div class="c">{%trans "Province"%}</div>
  {%for k, v in result.candida_id%}
  <div class="c">{{v}}</div>
  {%endfor%}
 </div>
  {%for key, value in result.result_by_city.province%}
   <div class="f">
    <div class="c">{{value.location.local_name}}</div>
    {%for k, v in value.data%}
     <div class="c">{{v|fitNumber}}</div>
    {%endfor%}
   </div>
  {%endfor%}
</div>
{% endif %}
{%endblock%}


{%block city_result%}
{% if result.result_by_city.city %}
<p class="d-title">{% trans "Candidates' Votes on Cities" %}</p>
<div class="city-results">
 <div class="f header">
  <div class="c">{%trans "City"%}</div>
  {%for k, v in result.candida_id%}
  <div class="c">{{v}}</div>
  {%endfor%}
  </div>
  {%for key, value in result.result_by_city.city%}
  <div class="f">
  <div class="c">{{value.location.local_name}}</div>
  {%for k, v in value.data%}
  <div class="c">{{v|fitNumber}}</div>
  {%endfor%}
  </div>
  {%endfor%}
 </div>
{% endif %}
{%endblock%}






{%block senario%}
{%if result.senario%}
 <div class="chart" id="" data-vals='[{"key"":۱۳۹۶-۰۲-۰۶","value":2},{"key":"۱۳۹۶-۰۲-۰۳","value":3}]' style="width:100%;direction:ltr;height: 300px;margin-bottom: 5em"></div>
{%endif%}
{%endblock%}


{%block time_line%}
{%if result.time_line%}
  <div class="timeline">
  {%for key, value in result.time_line%}
  <a class="circle {%if value.en_url == url.path or value.fa_url == url.path%}active{%endif%}" href="#">
   <div class="image round low">
    <img src="{{url.static}}images/election/1.png">
   </div>
  </a>
  {%endfor%}
 </div>
{%endif%}
{%endblock%}
